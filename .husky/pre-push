#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Verificar se hÃ¡ alteraÃ§Ãµes antes do lint
git diff --quiet --exit-code
CHANGES_BEFORE=$?

# Executar verificaÃ§Ãµes
echo "ğŸ” Executando verificaÃ§Ãµes pre-push..."

echo "ğŸ“ Verificando TypeScript..."
yarn tsc

echo "ğŸ”§ Executando lint fix..."
yarn lint:fix

echo "âœ… Verificando lint..."
yarn lint

echo "ğŸ§ª Executando testes..."
yarn test

# Verificar se houve alteraÃ§Ãµes apÃ³s o lint fix
git diff --quiet --exit-code
CHANGES_AFTER=$?

# Se houve alteraÃ§Ãµes e nÃ£o havia antes, fazer commit automÃ¡tico
if [ $CHANGES_BEFORE -eq 0 ] && [ $CHANGES_AFTER -ne 0 ]; then
    echo "ğŸ”§ Lint fix aplicou alteraÃ§Ãµes. Fazendo commit automÃ¡tico..."
    git add .
    git commit -m "style: aplicar lint fix automÃ¡tico

AlteraÃ§Ãµes aplicadas automaticamente pelo pre-push hook:
- FormataÃ§Ã£o de cÃ³digo com Prettier
- CorreÃ§Ãµes de ESLint"
    echo "âœ… Commit automÃ¡tico realizado"
fi

echo "ğŸš€ Pre-push concluÃ­do com sucesso!"
